[2024/02/07 04:13:54] - Namespace(attack='pgd', attack_iters=10, batch_size=128, chkpt_iters=10, cutout=False, cutout_len=None, data_dir='../cifar-data', epochs=200, epsilon=8, eval=False, fgsm_alpha=1.25, fgsm_init='random', fname='cifar_model', half=False, l1=0, l2=0, lr_drop_epoch=100, lr_max=0.1, lr_one_drop=0.01, lr_schedule='piecewisezoom', mixup=False, mixup_alpha=None, model='PreActResNet18', norm='l_inf', pgd_alpha=2, restarts=1, resume=0, seed=0, val=False, width_factor=10)
[2024/02/07 04:13:54] - model: PreActResNet18
[2024/02/07 04:13:54] - l2: 0
[2024/02/07 04:13:54] - l1: 0
[2024/02/07 04:13:54] - batch_size: 128
[2024/02/07 04:13:54] - data_dir: ../cifar-data
[2024/02/07 04:13:54] - epochs: 200
[2024/02/07 04:13:54] - lr_schedule: piecewisezoom
[2024/02/07 04:13:54] - lr_max: 0.1
[2024/02/07 04:13:54] - lr_one_drop: 0.01
[2024/02/07 04:13:54] - lr_drop_epoch: 100
[2024/02/07 04:13:54] - attack: pgd
[2024/02/07 04:13:54] - epsilon: 8
[2024/02/07 04:13:54] - attack_iters: 10
[2024/02/07 04:13:54] - restarts: 1
[2024/02/07 04:13:54] - pgd_alpha: 2
[2024/02/07 04:13:54] - fgsm_alpha: 1.25
[2024/02/07 04:13:54] - norm: l_inf
[2024/02/07 04:13:54] - fgsm_init: random
[2024/02/07 04:13:54] - fname: cifar_model
[2024/02/07 04:13:54] - seed: 0
[2024/02/07 04:13:54] - half: False
[2024/02/07 04:13:54] - width_factor: 10
[2024/02/07 04:13:54] - resume: 0
[2024/02/07 04:13:54] - cutout: False
[2024/02/07 04:13:54] - cutout_len: None
[2024/02/07 04:13:54] - mixup: False
[2024/02/07 04:13:54] - mixup_alpha: None
[2024/02/07 04:13:54] - eval: False
[2024/02/07 04:13:54] - val: False
[2024/02/07 04:13:54] - chkpt_iters: 10
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ../cifar-data/cifar-10-python.tar.gz
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 32768/170498071 [00:00<10:11, 278976.07it/s]  0%|          | 65536/170498071 [00:00<10:18, 275577.39it/s]  0%|          | 98304/170498071 [00:00<10:18, 275517.07it/s]  0%|          | 229376/170498071 [00:00<04:44, 599431.69it/s]  0%|          | 458752/170498071 [00:00<02:38, 1075421.17it/s]  1%|          | 917504/170498071 [00:00<01:24, 2014798.34it/s]  1%|          | 1835008/170498071 [00:00<00:43, 3863891.33it/s]  2%|▏         | 3702784/170498071 [00:00<00:21, 7600494.44it/s]  4%|▍         | 6815744/170498071 [00:01<00:12, 13365495.90it/s]  6%|▌         | 9961472/170498071 [00:01<00:09, 17291589.65it/s]  8%|▊         | 13074432/170498071 [00:01<00:07, 19954601.89it/s] 10%|▉         | 16220160/170498071 [00:01<00:07, 21776930.81it/s] 11%|█▏        | 19333120/170498071 [00:01<00:06, 23139942.27it/s] 13%|█▎        | 22446080/170498071 [00:01<00:06, 24051797.88it/s] 15%|█▌        | 25591808/170498071 [00:01<00:05, 24650764.76it/s] 17%|█▋        | 28704768/170498071 [00:01<00:05, 25070049.04it/s] 19%|█▊        | 31850496/170498071 [00:02<00:05, 25237363.58it/s] 21%|██        | 34963456/170498071 [00:02<00:05, 25729342.64it/s] 22%|██▏       | 38043648/170498071 [00:02<00:05, 25725170.38it/s] 24%|██▍       | 41156608/170498071 [00:02<00:05, 25790632.65it/s] 26%|██▌       | 44269568/170498071 [00:02<00:04, 26572071.84it/s] 28%|██▊       | 47415296/170498071 [00:02<00:04, 25768368.20it/s] 30%|██▉       | 50495488/170498071 [00:02<00:04, 26447950.01it/s] 31%|███▏      | 53608448/170498071 [00:02<00:04, 26291893.50it/s] 33%|███▎      | 56721408/170498071 [00:02<00:04, 26217315.65it/s] 35%|███▌      | 59834368/170498071 [00:03<00:04, 26155193.41it/s] 37%|███▋      | 62652416/170498071 [00:03<00:04, 26682651.67it/s] 38%|███▊      | 65339392/170498071 [00:03<00:04, 25391537.09it/s] 40%|███▉      | 67895296/170498071 [00:03<00:04, 24215806.12it/s] 41%|████▏     | 70352896/170498071 [00:03<00:04, 23204250.07it/s] 43%|████▎     | 73302016/170498071 [00:03<00:04, 23510235.45it/s] 45%|████▍     | 76382208/170498071 [00:03<00:03, 23983975.69it/s] 47%|████▋     | 79462400/170498071 [00:03<00:03, 24318912.46it/s] 48%|████▊     | 82608128/170498071 [00:04<00:03, 24665939.07it/s] 50%|█████     | 85688320/170498071 [00:04<00:03, 24784422.14it/s] 52%|█████▏    | 88801280/170498071 [00:04<00:03, 24926011.00it/s] 54%|█████▍    | 91914240/170498071 [00:04<00:03, 25244512.32it/s] 56%|█████▌    | 95027200/170498071 [00:04<00:02, 25453347.16it/s] 58%|█████▊    | 98140160/170498071 [00:04<00:02, 25608096.97it/s] 59%|█████▉    | 101253120/170498071 [00:04<00:02, 25695540.12it/s] 61%|██████    | 104366080/170498071 [00:04<00:02, 25797313.24it/s] 63%|██████▎   | 107446272/170498071 [00:05<00:02, 25786073.50it/s] 65%|██████▍   | 110559232/170498071 [00:05<00:02, 25840313.49it/s] 67%|██████▋   | 113672192/170498071 [00:05<00:02, 25878293.18it/s] 68%|██████▊   | 116785152/170498071 [00:05<00:02, 25915664.23it/s] 70%|███████   | 119865344/170498071 [00:05<00:01, 25885838.19it/s] 72%|███████▏  | 123011072/170498071 [00:05<00:01, 25939959.32it/s] 74%|███████▍  | 126091264/170498071 [00:05<00:01, 25940700.56it/s] 76%|███████▌  | 129204224/170498071 [00:05<00:01, 25922827.13it/s] 78%|███████▊  | 132317184/170498071 [00:05<00:01, 25934102.17it/s] 79%|███████▉  | 135430144/170498071 [00:06<00:01, 25968597.64it/s] 81%|████████▏ | 138543104/170498071 [00:06<00:01, 25964350.34it/s] 83%|████████▎ | 141656064/170498071 [00:06<00:01, 25975440.68it/s] 85%|████████▍ | 144801792/170498071 [00:06<00:00, 25974292.16it/s] 87%|████████▋ | 147881984/170498071 [00:06<00:00, 25978661.47it/s] 89%|████████▊ | 150994944/170498071 [00:06<00:00, 25968085.51it/s] 90%|█████████ | 154140672/170498071 [00:06<00:00, 25979907.02it/s] 92%|█████████▏| 157253632/170498071 [00:06<00:00, 26050459.51it/s] 94%|█████████▍| 159875072/170498071 [00:07<00:00, 26067830.17it/s] 95%|█████████▌| 162496512/170498071 [00:07<00:00, 24895120.83it/s] 97%|█████████▋| 165019648/170498071 [00:07<00:00, 23819684.32it/s] 98%|█████████▊| 167542784/170498071 [00:07<00:00, 23063729.58it/s]100%|██████████| 170498071/170498071 [00:07<00:00, 22886875.26it/s]
[2024/02/07 04:14:05] - Epoch 	 Train Time 	 Test Time 	 LR 	 	 Train Loss 	 Train Acc 	 Train Robust Loss 	 Train Robust Acc 	 Test Loss 	 Test Acc 	 Test Robust Loss 	 Test Robust Acc
Extracting ../cifar-data/cifar-10-python.tar.gz to ../cifar-data
Files already downloaded and verified
Traceback (most recent call last):
  File "/home/c01yuxu/CISPA-home/RML/train_cifar.py", line 503, in <module>
    main()
  File "/home/c01yuxu/CISPA-home/RML/train_cifar.py", line 341, in main
    lr = lr_schedule(epoch + (i + 1) / len(train_batches))
UnboundLocalError: local variable 'lr_schedule' referenced before assignment
